\documentclass{exam}
\usepackage{babel}
\usepackage[utf8]{inputenc}
\usepackage{amsmath, amsthm, amssymb}
\usepackage{ragged2e}
\usepackage{blindtext}
\usepackage{lmodern}
\usepackage{tcolorbox}

\pagestyle{empty}
\renewcommand{\theenumi}{\alph{enumi}} 
%\newcommand{\solvedByEnki}{$*^{E}$} 
%\newcommand{\solvedByRicardo}{$*^{R}$}

\DeclareMathOperator*{\argmin}{arg\,min}

\begin{document}

\begin{center}
    \textbf{\Large Exercises 1.9}    
\end{center}

\section*{Exercise 1.9.1}
A factory has $n$ suppliers that produce quantities $x_1 \dots x_n$ per day. The factory is connected with suppliers by a system of roads, which
can be at variable capacities $c_1 \dots c_n$, so that the factory is supplied
daily the amount $x = c_1 x_1 + \dots + c_n x_n$.
\begin{enumerate}
    \item Given that the factory production process starts when the supply reaches the critical daily level $b$, write a formula for the daily factory revenue.
    \item Formulate the problem as a learning problem.
\end{enumerate}   

\section*{Exercise 1.9.2}
A number of finantial institutions, each having a wealth $x_i$, deposit amounts of money in a fund, at some adjustable rates of 
deposit $w_i$, so the money in the fund is given by $x = x_1 w_1 + \dots + x_n w_n$. The fund is \\
set up to function as in the following: as long a sthe fund has less than a certain reserve fund $M$, the fund manager does not invest. Only the
money exceeding the reserve found $M$ is invested. Let $k = e ^ {r t}$, where $r$ and $t$ denote the investment rate of return and time of investment, respectively.
\begin{enumerate}
    \item Find the formula for the investment.
    \item Formulate the problem as a learning problem.
\end{enumerate}

\section*{Exercise 1.9.3}
\begin{enumerate}
    \item Given a continous function $f: [0,1] \rightarrow \mathbb{R}$, find a linear function $L(x) = ax + b$ with $L(0) = f(0)$ and such that 
    $\frac{1}{2} \int^{1}_{0}(L(x) - f(x))^2 dx$ is minimized.
    \item  Given a continous function $f: [0,1] \times [0,1] \rightarrow \mathbb{R}$, find a linear function $L(x,y) = ax + by + c$ with $L(0,0) = f(0,0)$ and 
    such that the error $\frac{1}{2} \int_{[0,1]^2}(L(x,y) - f(x,y))^2 dx$ is minimized
\end{enumerate}

\section*{Exercise 1.9.4}
For any compact $K \subset \mathbb{R}^n$ we associate the symetric matrix $\displaystyle \rho_{ij} = \int_{K} x_i x_j d x_1 \dots d x_n$ The invertiblity of \\
\\
the matrix $(\rho_{ij})$ depends both on the shape of $K$ and the dimension $n$.
\begin{enumerate}
    \item Show that if $n = 2$ then $\text{det}(\rho_{ij}) \neq 0$, for any compact $K \subset \mathbb{R}^2$.
    \item Asume $K = [0,1]^n$. Show that $\text{det}(\rho_{ij}) \neq 0 \text{, for any $n \geq 1$}$.
\end{enumerate}

\newpage

\begin{center}    
    \section*{SOLUTIONS}
\end{center}

\subsection*{1.9.1 (a)}
Let $\pmb{\text{c}} := (c_1 ,\ldots, c_n)$ and $\pmb{\text{p}} := (x_1 ,\ldots, x_n)$ the roads variable capacities and the produced quantities, respectively. Then $x = \pmb{\text{c}} \cdot \pmb{\text{p}}$. Suppose the cost of product per item is $k$, so if the 
production starts after the critical daily level $b$ is meet. This is, $x - b > 0 $. It is clear that the revenue $L_{r}$ will be given by the formula: \\
\begin{equation*}
    \hspace*{-7cm} L_{r}(\pmb{\text{p}};\pmb{\text{c}},b) = 
        \left\{
        \begin{aligned}
            & k ( \pmb{\text{c}} \cdot \pmb{\text{p}} - b), & \text{if } \pmb{\text{c}} \cdot \pmb{\text{p}} - b > 0\\
            & 0,  \text{ otherwise}.
        \end{aligned}
        \right.
\end{equation*}

\subsection*{1.9.1 (b)}
The learning problem can be stated like this: "Given a vector of road variable capacities $\pmb{\text{c}}$ and a daily critical level $b$, provided that the production 
of the $n$ factories is expressed by the vector $\pmb{\text{p}}$. The goal is find a vector $\pmb{\text{p}}^\star$ and a scalar $b^\star$ such that the ideal revenue
$r(\pmb{\text{p}}) = \pmb{\text{c}} \cdot \pmb{\text{p}} $ is close that provided by the data $L_{r}(\pmb{\text{p}};\pmb{\text{c}},b)$ (obtained in 1.9.1 (a))". In other words, the pair $(\pmb{\text{c}}^\star,b^\star)$ minimizes the distance (in the $\mathcal{L}_2$ sense)
between $r(\pmb{\text{p}})$ and $L_{r}(\pmb{\text{p}};\pmb{\text{c}},b)$. In symbols: \\
\begin{equation*}
    \hspace*{-7cm}(\pmb{\text{c}}^\star,b^\star) = \argmin_{\tiny\pmb{\text{c}} \in \mathbb{R}^n \text{, } p \in \mathbb{R}} \displaystyle \int_{\mathcal{K}} (r(\pmb{\text{p}}) - L_{r}(\pmb{\text{p}};\pmb{\text{c}},b))^2 d \pmb{\text{p}}.
\end{equation*} 

\subsection*{1.9.2 (a)}
If $\pmb{\text{w}} := (w_1 \ldots w_n)$ encodes the adjustable rates of deposit corresponding to each of the $n$ finantial \\
institutions and $\pmb{\text{x}} := (x_1 \ldots x_n)$ the wealth of each of the $n$ institutions, the money in the fund is expressed by $x = \pmb{\text{w}} \cdot \pmb{\text{x}}$. It's known that the fund is set to function if the revenue exceds a given capital 
$M$ and that the investment grows proportional to $e^{r t}$(profit per investment), then it is clear that the invesment is given by the formula: \\
\begin{equation*}
    \hspace*{-7cm} L_{I}(\pmb{\text{x}};\pmb{\text{w}},M) = 
        \left\{
        \begin{aligned}
            & e^{r t} ( \pmb{\text{w}} \cdot \pmb{\text{x}} - M), \text{ if }   \pmb{\text{w}} \cdot \pmb{\text{x}}  > M \\
            & 0, \text{ otherwise}.
        \end{aligned}
        \right.
\end{equation*}

\subsection*{1.9.2 (b)}
Let $I(\pmb{\text{x}}) = x = \pmb{\text{w}} \cdot \pmb{\text{x}}$ be the ideal investment, $L_{I}(\pmb{\text{x}};\pmb{\text{w}},M)$ given in 1.9.2 (b). Then the learning problem 
can be stated as follows: "Given the vector of wealth of the $n$ institutions $\pmb{\text{x}}$, the vector of adjustatable rates of deposit $\pmb{\text{w}}$ and that inversions are placed 
in the fund if the capital exceeds the quantity $M$. It is needed to find a tuple $(\pmb{\text{w}}^\star,M)$ that minimizes the distance (in the $\mathcal{L}_2$ sense) between the functions
$I(\pmb{\text{x}})$ and $L_{I}(\pmb{\text{x}};\pmb{\text{w}},M)$" \\
\\
In mathematical terms this means that: \begin{equation*} 
    (\pmb{\text{w}}^\star,M^\star) = \argmin_{\tiny\pmb{\text{w}} \in \mathbb{R}^n \text{, } M \in \mathbb{R}} \displaystyle \int_{\mathcal{K}} (I(\pmb{\text{x}}) - L_{I}(\pmb{\text{x}};\pmb{\text{c}},M))^2 d \pmb{\text{x}}.
\end{equation*} 

\subsection*{1.9.3 (a)}
It follows from the contrain $f(0) = L(0)$ that $b = f(0)$, that said, the task is now to find an $a^\star$ such that\\
$\displaystyle a^\star = \argmin_{ \tiny a \in \mathbb{R}} {\lVert f(x) - L(x) \rVert}^2_{\mathcal{L}_2([0,1])}$. Now, let $C(a) := {\lVert f(x) - L(x) \rVert}^2_{\mathcal{L}_2([0,1])}$, then $C(a)$ has the most explicit form: 
\begin{equation*}
    C(a) = \displaystyle \int_{[0,1]} (f(x) - ax -f(0))^2 d x.
\end{equation*}
The extremizing $a^\star$ can be found by computing critical points and applying the second derivative test to determine the nature of the critical point. Then one has: \\

$\frac{d}{da} C(a) = \displaystyle\int_{[0,1]} -2(f(x) - ax -f(0)) x d x = a \displaystyle \int_{[0,1]} 2x^2 d x +  \displaystyle\int_{[0,1]} 2(f(0) - f(x)) x d x$
\end{document}